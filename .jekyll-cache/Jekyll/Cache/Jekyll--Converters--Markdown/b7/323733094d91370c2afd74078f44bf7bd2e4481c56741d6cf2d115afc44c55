I"»<p>å¸¸è§çš„ç”µå­é‚®ä»¶åè®®:</p>
<ul>
  <li>SMTP
    <ul>
      <li>å‘é€å’Œä¸­è½¬å‘å‡º</li>
      <li>TCP-25</li>
    </ul>
  </li>
  <li>POP3
    <ul>
      <li>å­˜å‚¨åˆ°æœ¬åœ°</li>
      <li>TCP-110</li>
    </ul>
  </li>
  <li>IMAP4
    <ul>
      <li>åœ¨æœ¬åœ°è®¿é—®</li>
      <li>TCP-143</li>
    </ul>
  </li>
</ul>

<p><strong>MUA</strong></p>
<ul>
  <li>Mail User Agent</li>
  <li>é‚®ä»¶ç”¨æˆ·ä»£ç†</li>
  <li>ç”¨æˆ·æ”¶å‘é‚®ä»¶çš„æœåŠ¡å™¨</li>
</ul>

<p><strong>MDA</strong></p>
<ul>
  <li>Mail Delivery Agent</li>
  <li>é‚®ä»¶æŠ•é€’ä»£ç†</li>
  <li>ä¿å­˜é‚®ä»¶çš„é‚®å±€æœåŠ¡å™¨</li>
</ul>

<p><strong>MTA</strong></p>
<ul>
  <li>Mail Transfer Agent</li>
  <li>é‚®ä»¶ä¼ è¾“ä»£ç†</li>
  <li>è½¬å‘å¤„ç†ä¸åŒç”µå­é‚®ä»¶æœåŠ¡ä¾›åº”å•†ä¹‹é—´çš„é‚®ä»¶</li>
</ul>

<p>ç”µå­é‚®ä»¶ä¼ è¾“è¿‡ç¨‹</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MUA --SMTP--&gt; MTA --SMTP--&gt; MTA --POP3/IMAP4--&gt; MUA
</code></pre></div></div>

<p>ä¼ä¸šä¸­éƒ¨ç½²é‚®ä»¶æœåŠ¡çš„æ³¨æ„ç‚¹:</p>
<ol>
  <li>ååƒåœ¾å’Œåç—…æ¯’</li>
  <li>é‚®ä»¶åŠ å¯†</li>
  <li>å†…å®¹å®¡æ ¸</li>
  <li>é˜²èŒƒDDoS(åˆ†å¸ƒå¼æ‹’ç»æœåŠ¡)æ”»å‡»</li>
</ol>

<h3 id="éƒ¨ç½²åŸºç¡€çš„ç”µå­é‚®ä»¶ç³»ç»Ÿ">éƒ¨ç½²åŸºç¡€çš„ç”µå­é‚®ä»¶ç³»ç»Ÿ</h3>

<p>PostfixæœåŠ¡ç¨‹åº</p>
<ul>
  <li>åŸºäºSMTPåè®®</li>
  <li>è´Ÿè´£å‘ä»¶</li>
</ul>

<p>DovecotæœåŠ¡ç¨‹åº</p>
<ul>
  <li>åŸºäºPOP3åè®®</li>
  <li>è´Ÿè´£å‘ä»¶</li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>RHEL5/6 -- SendmailæœåŠ¡ç¨‹åº
RHEL7   -- PostfixæœåŠ¡ç¨‹åº
</code></pre></div></div>

<p>ç”µå­é‚®ä»¶åœ°å€ â€œç”¨æˆ·å@ä¸»æœºåœ°å€(åŸŸå)â€ å¦‚æœä¸»æœºåœ°å€æ˜¯IPåœ°å€, é‚£ä¹ˆä¼šå’ŒSSHææ··<br />
æ‰€ä»¥ä¸€èˆ¬éƒ½ç”¨åŸŸåä½œä¸ºä¸»æœºåœ°å€, é‚£ä¹ˆç”µå­é‚®ä»¶æœåŠ¡å™¨å¦‚æœèƒ½æä¾›DNSæœåŠ¡å™¨å°±å¯ä»¥æ›´å¥½çš„æ£€éªŒç”µå­é‚®ä»¶ç³»ç»Ÿçš„é…ç½®æ•ˆæœ<br /></p>

<p>å…ˆæå®šbindæœåŠ¡, å‚è€ƒLinuxä¸­çš„åŸŸåè§£æ<br /></p>

<ol>
  <li>ä¿®æ”¹é‚®ä»¶æœåŠ¡å™¨çš„hostname
    <ul>
      <li>ä¿è¯æœåŠ¡å™¨çš„ä¸»æœºåå’Œå‘ä¿¡åŸŸåä¸€è‡´
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vim /etc/hostname
</code></pre></div>        </div>
        <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mail.centos7.com
</code></pre></div>        </div>
      </li>
    </ul>
  </li>
  <li>æ¸…ç©ºiptablesé˜²ç«å¢™ç­–ç•¥, å¹¶ä¿æŒç­–ç•¥çŠ¶æ€
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>iptables -F
service iptables save
</code></pre></div>    </div>
  </li>
  <li>ä¸ºç”µå­é‚®ä»¶ç³»ç»Ÿæä¾›DNSæœåŠ¡
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>vim /etc/named.conf
</code></pre></div>    </div>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>11 listen-on port 53 { any; };
17 allow-query { any; };
</code></pre></div>    </div>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl restart named
systemctl enable named
</code></pre></div>    </div>
  </li>
</ol>

<h3 id="é…ç½®postfixæœåŠ¡ç¨‹åº">é…ç½®PostfixæœåŠ¡ç¨‹åº</h3>

<ol>
  <li>å®‰è£…PostfixæœåŠ¡ç¨‹åº, ç¦ç”¨iptablesé˜²ç«å¢™
    <blockquote>
      <p>yum install postfix<br /></p>
      <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systenctl disable iptables
</code></pre></div>      </div>
    </blockquote>
  </li>
  <li>é…ç½®Postfix
    <ul>
      <li>ä¸»é…ç½®æ–‡ä»¶: <code class="language-plaintext highlighter-rouge">/etc/postfix/main.cf</code></li>
      <li>é‡è¦å‚æ•°</li>
      <li>
        <table>
          <thead>
            <tr>
              <th style="text-align: left">å‚æ•°</th>
              <th style="text-align: left">ä½œç”¨</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="text-align: left">myhostname</td>
              <td style="text-align: left">é‚®å±€ç³»ç»Ÿçš„ä¸»æœºå</td>
            </tr>
            <tr>
              <td style="text-align: left">mydomain</td>
              <td style="text-align: left">é‚®å±€ç³»ç»Ÿçš„åŸŸå</td>
            </tr>
            <tr>
              <td style="text-align: left">myorigin</td>
              <td style="text-align: left">ä»æœ¬æœºå‘å‡ºé‚®ä»¶çš„åŸŸååç§°</td>
            </tr>
            <tr>
              <td style="text-align: left">inet_interfaces</td>
              <td style="text-align: left">ç›‘å¬çš„ç½‘å¡æ¥å£</td>
            </tr>
            <tr>
              <td style="text-align: left">mydestination</td>
              <td style="text-align: left">å¯æ¥æ”¶é‚®ä»¶çš„ä¸»æœºåæˆ–åŸŸå</td>
            </tr>
            <tr>
              <td style="text-align: left">mynetworks</td>
              <td style="text-align: left">è®¾ç½®å¯ä»¥è½¬å‘å“ªäº›ä¸»æœºçš„é‚®ä»¶</td>
            </tr>
            <tr>
              <td style="text-align: left">relay_domains</td>
              <td style="text-align: left">è®¾ç½®å¯ä»¥è½¬å‘å“ªäº›ç½‘åŸŸçš„é‚®ä»¶</td>
            </tr>
          </tbody>
        </table>
      </li>
    </ul>
  </li>
</ol>

<ul>
  <li>ä¿®æ”¹5å¤„
    <ul>
      <li>line-76 <code class="language-plaintext highlighter-rouge">myhostname = mail.centos7.com</code></li>
      <li>line-83 <code class="language-plaintext highlighter-rouge">mydomain = centos7.com</code></li>
      <li>line-99 <code class="language-plaintext highlighter-rouge">myorigin = $mydomain</code></li>
      <li>line-116 <code class="language-plaintext highlighter-rouge">inet-interfaces = all</code></li>
      <li>line-164 <code class="language-plaintext highlighter-rouge">mydestination = $myhostname, $mydomain</code>
        <ol>
          <li>åˆ›å»ºç”µå­é‚®ä»¶ç³»ç»Ÿçš„ç™»å½•è´¦æˆ·</li>
        </ol>
      </li>
    </ul>
  </li>
  <li>Postfixå¯ä»¥è°ƒç”¨æœ¬åœ°è´¦æˆ·çš„ç”¨æˆ·åå’Œå¯†ç , åœ¨æœ¬åœ°åˆ›å»ºç”¨æˆ·å³å¯
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>usradd mailuser
echo "123.com" | passwd --stdin mailuser
</code></pre></div>    </div>
  </li>
  <li>é‡å¯æœåŠ¡, æ·»åŠ åˆ°å¼€æœºå¯åŠ¨é¡¹
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl restart postfix
systemctl enable postfix
</code></pre></div>    </div>
  </li>
</ul>

:ET