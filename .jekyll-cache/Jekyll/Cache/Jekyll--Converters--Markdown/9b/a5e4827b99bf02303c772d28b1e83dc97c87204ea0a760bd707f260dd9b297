I"<p>受控端操作系统以 windows server 2008R2 SP1 企业版为样例<br /></p>
<h2 id="控制端">控制端</h2>
<p>控制端Linux需要用pip安装一个python包: <code class="language-plaintext highlighter-rouge">pywinrm</code><br /></p>
<h2 id="受控端">受控端</h2>
<ol>
  <li>安装 <code class="language-plaintext highlighter-rouge">Microsoft .NET Framework 4.5</code>
    <ul>
      <li><code class="language-plaintext highlighter-rouge">注意顺序</code>: 要先安装.NET4.5后升级powershell, 并且重启机器</li>
      <li>推荐使用离线安装包</li>
    </ul>
  </li>
  <li>升级powershell到<code class="language-plaintext highlighter-rouge">4.0</code>以上版本
    <ul>
      <li>windows server 2012及以上的版本默认powershell是4.0不需要升级</li>
      <li><code class="language-plaintext highlighter-rouge">get-host</code>命令可以查看powershell的版本</li>
      <li>2008R2装完机默认powershell是2.0版本
<img src="/assets/post_image/ansible_windows_1.png" width="80%" height="80%" /><br /></li>
      <li>升级完成并且重启后, get-host看到版本号为4.0
<img src="/assets/post_image/ansible_windows_2.png" width="80%" height="80%" /><br /></li>
    </ul>
  </li>
  <li>修改powershell的策略</li>
</ol>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>get-executionpolicy

</code></pre></div></div>
<ol>
  <li>设置windows的远程管理</li>
  <li>安装修补程序</li>
</ol>

:ET