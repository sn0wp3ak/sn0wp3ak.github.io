I"<p>FTP - File Transfer Protocol 文件传输协议<br /></p>
<blockquote>
  <p><code class="language-plaintext highlighter-rouge">yum install vsftpd</code><br />
<code class="language-plaintext highlighter-rouge">yum install ftp</code><br /></p>
</blockquote>

<p>TFTP - Trivial FTP 简易文件传输协议<br /></p>
<blockquote>
  <p><code class="language-plaintext highlighter-rouge">yum install tftp tftp-server</code><br /></p>
</blockquote>

<ul>
  <li>基于UDP</li>
  <li>简易, 开销小, 但是不如FTP可靠</li>
  <li>适合传输比较小的琐碎文件</li>
</ul>

<p>vsftpd - very secure ftp daemon 非常安全的FTP守护进程<br /></p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">vsftpd</code>是一个FTP服务程序<br />
<code class="language-plaintext highlighter-rouge">ftp</code>是一个客户端ftp管理工具<br />
<code class="language-plaintext highlighter-rouge">xinetd</code>是一个TFTP服务程序<br /></p>
</blockquote>

<p>FTP服务占用的端口 20 和 21<br /></p>
<ul>
  <li>port:20 用来传输数据(up/down)</li>
  <li>port:21 用来传递FTP命令和参数(C-&gt;S)</li>
</ul>

<p>iptables防火墙会默认禁用FTP协议的端口号, 在配置vsftpd服务之前需要清空防火墙策略并保存<br /></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>iptables -F
service iptables save
</code></pre></div></div>
<p>vsftpd服务的主配置文件: <code class="language-plaintext highlighter-rouge">/etc/vsftpd/vsftpd.conf</code><br />
想要得到一个比较清爽的配置文件, 以方便管理服务;<br />
先备份配置文件, 在利用grep命令的反选参数以覆盖的方式重定向写入原配置文件<br /></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mv /etc/vsftpd/vsftpd.conf /etc/vsftpd/vsftpd.conf_bak
grep -v "#" /etc/vsftpd/vsftpd.conf_bak &gt; /etc/vsftpd/vsftpd.conf
</code></pre></div></div>

<p>vsftpd登录服务器的3种认证模式:<br /></p>
<ul>
  <li>匿名开放模式</li>
  <li>本地用户模式</li>
  <li>虚拟用户模式(推荐)</li>
</ul>

<p>安全性: 匿名开放 &lt; 本地用户 &lt; 虚拟用户<br /></p>

<p><strong><code class="language-plaintext highlighter-rouge">匿名开放模式</code></strong><br />
任何人都可以不用密码登录FTP服务器<br />
最不安全的认证模式<br />
vsftpd默认启动了匿名开放模式<br />
可以向匿名用户开放的权限参数和作用:<br /></p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">参数</th>
      <th style="text-align: left">作用</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">anonymous_enable=YES</td>
      <td style="text-align: left">允许匿名访问</td>
    </tr>
    <tr>
      <td style="text-align: left">anon_umask=022</td>
      <td style="text-align: left">匿名用户上传文件的umask值</td>
    </tr>
    <tr>
      <td style="text-align: left">anon_upload_enable=YES</td>
      <td style="text-align: left">允许匿名用户上传文件</td>
    </tr>
    <tr>
      <td style="text-align: left">anon_mkdir_write_enable=YES</td>
      <td style="text-align: left">允许匿名用户创建目录</td>
    </tr>
    <tr>
      <td style="text-align: left">anon_other_write_enable=YES</td>
      <td style="text-align: left">允许匿名用户修改目录名称或删除目录</td>
    </tr>
  </tbody>
</table>

<p>在主配置文件中加入以上参数, 保存退出<br />
重启vsftpd服务并加入开机启动项<br /></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl restart vsftpd
systemctl enable vsftpd
</code></pre></div></div>
<p>匿名开放模式下的账户统一是: anonymous ; 密码为空<br /></p>

<p>在清空防火墙策略并配置完vsftpd参数后, 匿名用户创建目录时提示权限拒绝, 是什么原因呢?<br /></p>

<p>其实vsftpd服务在匿名开放模式下默认访问服务器的<code class="language-plaintext highlighter-rouge">/var/ftp</code>目录, 而该目录只有root用户才具备写入的权限, 需要我们把该目录的owner改成ftp这个系统用户<br /></p>

:ET