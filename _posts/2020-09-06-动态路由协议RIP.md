---
title: 动态路由协议RIP
date: 2020-09-06
categories:
- Network
---
**动态路由**

* 基于某种路由协议实现

**动态路由的特点**

* 减少了管理任务
* 占用了网络带宽
* 硬件资源要求高

**动态路由协议概述**

* 路由器之间用来交换信息的语言

**度量值**

* Metric 

* 跳数, 带宽, 负载, 时延, 可靠性, 成本

**静态路由和动态路由的比较**

* 网络中静态路由和动态路由相互补充 

**收敛**

* 所有路由器都达到一致状态的过程

**按照路由执行的算法分类**

* 距离矢量路由协议
  * 依据从源网络到目标网络所经过的路由器的个数选择路由
  * RIP, IGRP
* 链路状态路由协议
  * 综合考虑从源网络到目标网络的各条路径的情况选择路由
  * OSPF, IS-IS

**RIP是距离-矢量路由选择协议   度量值: 跳数**

* RIP的基本概念
  * 定期更新
  * 邻居
  * 广播更新
  * 全路由表更新
  
* 路由器学习到直连路由

* 更新周期30s一到, 路由器会向邻居发送路由表

* 每过30s, 再次发送路由表
  * Next hop 下一跳
  * 条目类型 R
  * 学习Metirc + 1
  
* RIP度量值为跳数
  
  * 最大跳数15跳, 16跳为不可达
  
* RIP更新时间
  
  * 每隔30s发送路由更新消息, UDP520端口
  
* RIP路由更新消息的方式
  
  * 发送整个路由表信息
  
* **路由环路**
  * 如果某条线路坏了, Hop自动被标记为16
  * 此时路由器错误的学习了邻居的Hop值较低的数据, 又把Hop16更新掉了, 形成了路由环路
  * 路由器继续将该条目发送给邻居, 虽然Metric值不是最小但是因为来自同一路由器, 也得学习
  * 循环往复, 直到这两个路由的该条目Hop值都变成16
  
* **执行水平分割可以阻止路由环路的发生**
  * 从一个接口学习到的路由信息, 不再从这个接口发回去 (从别人那学的, 不再返回头教别人)
  * 同时也能减少路由更新信息占用的链路带宽资源

* **命令**

  ```
  conf t
  router rip
  	version 2
  	no auto-summary	   # 不按默认掩码学习, 关闭自动汇总
  	network 10.0.0.0   # 按默认子网掩码学习
  	network 20.0.0.0
  	exit
  ```

  RIP管理距离值: 120

  version1 只能学习默认子网的网段, 一般不用

  version2 常用
  
* **检查路由协议**

  1) 查路由表

  ```
  sh ip route
  ```

  2) 查运行配置

  ```
  sh run
  ```

  3) 查看协议

  ```
  sh ip protocols
  ```

  
