---
layout: post
title: 文件共享服务器
date: 2020-08-09
categories:
- Windows
---
**共享服务器概述**

> * 通过网络提供文件共享服务, 提供文件下载和上传服务(类似于FTP)
> * 协议: CIFS(微软开发的)

**创建共享**

> `方法: 文件夹右键属性-->共享-->开启共享-->设置共享名-->设置共享权限`
>
> 注意: 
>
> 1. 在本地登录时, 只受NTFS权限的影响
> 2. 在远程登录时, 将受共享和NTFS权限的共同影响, 并且取∩交集
> 3. 所有建议设置共享权限为everyone完全控制, 然后把具体的权限需要在NTFS权限中设置比较方便

**访问共享**

> * `运行--> \\IP地址\共享名`或者 `我的电脑地址栏--> \\IP地址\共享名`
> * 注意是共享名而不是文件夹名

**创建隐藏的共享**

> * 方法`共享名$`

**访问隐藏的共享**

> * `\\IP地址\共享名$`

**共享相关命令**

> * `net share`   # 列出共享列表
> * `net share 共享名=资源路径` # 创建共享
> * `net share 共享名 /del`  # 删除共享(临时删除)
> * 删除共享  
>   * 1.把临时删除命令写入`.bat`批处理文件中, 放入开机启动文件夹
>   * 2.修改注册表

**屏蔽系统隐藏共享自动产生**

> * **打开注册表编辑器**
>   * 打开注册表编辑器: 运行打开-->`regedit`
> * **定位共享服务注册表位置**
>   * `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\lanmanserver\parameters`
>   * 右键新建`REG_DWORD`类型的`AutoShareServer`键, 值为0, 基数无所谓

**查看本地网络连接状态**

> `netstat -an`

**关闭445服务**

> * 可以通过关闭445端口来屏蔽病毒传入(比如勒索病毒)
>   * 方法1: 打开`services.msc`, 并停止禁用server服务(`netstat -an`依然展示出445, 但是实际不起作用)
>   * 方法2: 禁止被访问445, 配置高级安全防火墙-入站规则(在win7及以上系统, win2008及以上系统)-端口号-tcp和udp两个协议都建规则-特殊端口号445
