---
layout: post
title: Python面向对象 -- 魔法方法
date: 2019-11-07
categories:
- python
---

在Python的类中, 方法名如果以2个下划线开头, 并且以2个下划线结尾, 那么这个方法就能成为魔法方法<br>

魔法方法的特点: 
* 在满足条件时会自动调用

### `__init__`方法
* 调用时机: 创建对象后自动调用, 即使你的类中没有定义, 也会被调用, 只不过是空代码
* 应用场景: 为对象添加属性, 也就是初始化对象的属性

```python
class cls():
    def __init__(self, ...):
        self.attr = value
```

### `__str__`方法
* 调用时机:
	1. print(对象)的时候会自动调用, 如果不定义`__str__`方法则会输出对象的地址
	2. str(对象) 做类型转换的时候也会自动调用
* 应用场景
	* 在用print()函数打印对象时, 不想要对象的地址, 而是想打印对象的其他信息时, 可以定义, 比如打印对象的属性值

注意: `__str__`方法必须返回一个字符串类型的值

### `__del__`方法
* 调用时机: 对象销毁的时候(释放内存空间, 删除的时候)
	1. 在整个程序结束时, 所有的对象和变量都会销毁, 此时对象的`__del__`方法将被调用
	2. 自己手动删除对象, 对象的引用计数为0的时候
* 应用场景: 垃圾回收, 清理资源

```python
a = Dog()
b = a
c = a
del a
del c
del b  # 引用计数为0, 此时调用__del__销毁对象
```

### `__repr__`方法
类似于`__str__`方法, 也是必须返回一个字符串<br>
* 调用时机:
	1. repr(对象)
	2. 将对象放入一个容器中, 然后打印这个容器
	3. 交互模式下, 直接写对象

`__str__`方法返回的字符串是给客户端用户看的信息, 而`__repr__`则是给程序员自己看的后台信息<br>

### `__new__`方法
1. 创建对象的方法, 在`__init__`方法之前调用, 返回对象的地址
2. 用来给对象分配内存地址
3. 单例模式




