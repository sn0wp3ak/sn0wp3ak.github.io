---
layout: post
title: DNS部署与安全
date: 2020-08-11
categories:
- windows
tags:
- dns
---
**DNS**

> Domain Name Service 域名服务
>
> 作用: 为客户机提供**域名解析服务**

**域名组成**

> * **1.域名组成概述**
>
>   * 形如"www.sina.com.cn"是一个域名, 从严格意义上说, "sina.com.cn"才能叫做域名(全球唯一), 而"www"是主机名
>   * 一般我们看到的"主机名.域名"称为**完全限定域名(FQDN)**, 一个域名之下可以有多个主机, 域名是全球唯一的, 所以"主机名.域名"肯定也是全球唯一的
>   * 一般情况下, 主机名会根据主机的功能而命名, 买下域名后, 前面的主机名就可以随意创建了
>
> * **2.域名组成**
>
>   * 树形结构
>
>   <img src="/assets/post_image/domain.png">
>
>   * 根域  `.`
>
>   * 顶级域
>
>     * 国家地区顶级域 `cn jp uk hk`
>     * 商业顶级域
>       * `com` 商业机构
>       * `gov` 政府机构
>       * `mil` 军事机构
>       * `edu` 教育机构
>       * `org` 民间组织架构
>       * `net` 互联网

**监听端口**

> * TCP/UDP 53

**DNS解析种类**

> * **按照查询方式分类**
>
>   * 1.递归查询: 客户机与本地DNS服务器之间
>   * 2.迭代查询: 本地DNS服务器与根或其他DNS服务器的解析过程
>
> * **DNS解析过程**
>
>   <img src="/assets/post_image/dns.png">
>
> * **按照查询内容分类**
>
>   * 1.正向解析: 已知域名, 解析IP地址( 域名-->IP )
>   * 2.反向解析: 已知IP地址, 解析域名( IP-->域名 )

**DNS服务器搭建过程**

> 1. 要求网卡IP是**静态IP地址**
> 2. 安装DNS服务器插件(就是安装并开启TCP及UDP协议的53端口)
> 3. 创建区域文件(负责一个域名后缀的解析, 比如: baidu.com为域名后缀, 一台DNS服务器内可以存放多个区域文件)
> 4. 新建A记录

**DNS客户机如何解析**

> 1. 指向DNS自动解析
> 2. 手工解析域名 `nslookup 域名`

**清除DNS缓存**

> * 客户机:
>   * 查看本地DNS缓存 `ipconfig /displaydns`
>   * 清除本地DNS缓存  `ipconfig /flushdns`
> * 服务器: `DNS管理工具-->查看-->高级, 右键清理缓存 `

**DNS请求顺序**

> * 客户机处理DNS请求顺序: `DNS缓存-->本地hosts文件-->本地DNS服务器`
> * 服务器处理DNS请求顺序: `DNS高速缓存-->本地区域解析文件-->DNS转发器-->根`

**DNS服务器分类**

> * 主要域名服务器
> * 辅助域名服务器
> * 根域名服务器
> * 高速缓存服务器

**域名解析记录类型**

> A记录 `主机(A)` : 正向解析记录
>
> PTR记录：反向解析记录
>
> CNAME记录: 给已存在的主机A记录起别名
>
> MX: 邮件交换记录
>
> SOA: 起始权威服务器 
>
> NS: 名称服务器
>

**反向DNS**

> 根据IP找NAME
>
> nslookup手工解析时, 会根据反向解析记录, 进行反向解析显示DNS服务器的名称(需要正向记录建立指针, 再设置反向记录)


